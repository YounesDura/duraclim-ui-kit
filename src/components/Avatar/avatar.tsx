import React, { useState } from 'react'
import styles from './avatar.module.scss'

type AvatarSize = 'sm' | 'md' | 'lg'

interface AvatarProps {
  /** URL (http(s)://â€¦) or local path ("/images/me.png") */
  image?: string
  alt?: string
  className?: string
  size?: AvatarSize
}

const sizeMap = {
  sm: 48,
  md: 96,
  lg: 128,
} as const

// your exact SVG, inlined as a React component
const FallbackAvatar = () => (
  <svg
    viewBox="0 0 778 898"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
    className={styles.avatarImage}
  >
    <path
      d="M375.441 0.43279C280.508 6.16612 199.308 73.3661 176.241 165.099C170.908 186.566 169.575 198.299 169.708 220.966C170.508 327.766 241.708 413.766 348.108 436.433C360.775 439.233 366.508 439.633 389.441 439.633C411.841 439.633 418.508 439.099 431.041 436.566C499.308 422.833 557.441 378.166 586.908 316.833C603.708 281.899 611.175 240.299 607.575 201.633C602.641 148.699 583.175 105.099 547.841 68.2995C501.841 20.2995 441.441 -3.56721 375.441 0.43279ZM424.108 28.2995C443.308 32.0328 459.708 37.6328 478.775 46.8328C505.441 59.6328 519.441 70.2995 536.241 90.2995C559.175 117.766 573.575 146.966 581.441 181.633C584.375 194.833 585.708 235.633 583.441 249.499C579.175 277.233 567.975 305.233 551.308 329.899C540.775 345.499 514.508 371.899 500.108 381.499C488.108 389.499 461.841 402.566 448.908 406.833C424.375 415.099 382.641 418.033 357.441 413.233C328.108 407.633 288.775 390.833 268.108 375.366C246.241 358.833 227.441 335.233 213.441 306.299C203.575 286.166 202.108 282.033 197.975 262.299C195.175 249.499 194.775 244.166 194.908 220.299C194.908 197.099 195.308 191.099 197.841 180.833C206.508 144.033 215.575 125.233 237.441 98.0328C253.708 77.7661 279.841 56.4328 301.441 45.7661C319.975 36.5661 349.441 27.8995 371.441 25.0995C381.041 23.8995 410.508 25.7661 424.108 28.2995Z"
      fill="black"
    />
    <path
      d="M216.907 494.966C163.174 509.632 119.841 534.432 85.3074 569.899C67.8408 587.899 58.6408 599.766 47.1741 618.566C26.6408 652.432 18.6408 677.099 8.90745 736.299C5.04079 759.899 3.97412 767.499 0.640789 798.566C-3.89254 840.432 15.7075 868.432 56.9075 878.832C68.7741 881.899 130.774 887.366 200.107 891.632C291.974 897.232 422.107 898.699 507.441 895.232C601.574 891.366 701.174 883.766 720.107 878.966C749.974 871.366 769.574 853.899 775.974 828.832C778.774 818.032 778.641 809.366 775.441 782.832C764.907 696.832 755.574 660.966 734.107 623.499C717.574 594.566 691.174 564.566 664.774 544.699C632.907 520.699 587.574 500.432 547.841 492.166C540.374 490.566 539.174 490.699 531.974 493.499C509.574 502.032 497.574 506.299 486.107 509.766C453.441 519.632 409.974 525.232 375.441 523.766C331.307 521.899 302.641 515.499 247.707 495.099C241.574 492.832 235.307 490.966 233.707 491.099C232.107 491.099 224.507 492.966 216.907 494.966ZM252.774 523.766C330.507 552.432 403.441 556.966 478.641 537.632C489.707 534.832 505.707 530.032 514.107 526.966C543.041 516.566 541.174 516.966 550.507 518.832C563.841 521.499 592.507 531.499 607.574 538.699C657.041 562.432 701.041 606.832 723.574 655.766C735.441 681.632 742.241 708.966 749.307 759.366C756.241 808.432 756.374 818.566 750.241 830.832C744.374 842.299 728.374 852.966 711.174 856.832C701.041 859.232 639.041 864.699 589.441 867.632C422.107 877.366 259.841 874.966 92.1074 860.166C61.9741 857.499 48.9075 853.099 35.9741 841.366C22.7741 829.232 20.9075 819.232 25.4408 782.832C31.3075 734.432 37.7075 700.966 44.7741 680.166C67.7075 613.632 120.507 558.299 186.774 531.632C200.241 526.166 227.441 517.899 232.241 517.766C234.374 517.632 243.707 520.432 252.774 523.766Z"
      fill="black"
    />
  </svg>
)

const Avatar: React.FC<AvatarProps> = ({
  image,
  alt = 'User avatar',
  className = '',
  size = 'sm',
}) => {
  const [errored, setErrored] = useState(false)
  const dimension = sizeMap[size]

  return (
    <div
      className={`${styles.avatarWrapper} ${styles.navbar} ${className}`}
      style={{ width: dimension, height: dimension }}
    >
      {image && !errored ? (
        <img
          src={image}
          alt={alt}
          className={styles.avatarImage}
          width={dimension}
          height={dimension}
          onError={() => setErrored(true)}
        />
      ) : (
        <FallbackAvatar />
      )}
    </div>
  )
}

export default Avatar